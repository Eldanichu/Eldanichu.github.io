import{M as o,N as p,O as A,P as l,L as P,Q as d,R as g,H as U,F as k,r as _,p as F,J as I,S as L,U as N,V as E,W as T,X as b,Y as $,T as C,Z as R,g as S,_ as O,$ as V,i as q,a0 as B}from"./@vue-1d7d99e0.js";import{c as z}from"./pinia-2d88c1ef.js";import{R as H,c as D,a as M}from"./vue-router-6f833e00.js";import{d as W,c as j,N as G,a as J,b as K,e as Q,f as X,g as Y,h as Z,i as ee,j as te,k as se,l as ne,m as ie,n as re,o as ae,p as oe,q as ce}from"./naive-ui-da77f4b1.js";import"./seemly-2e71c052.js";import"./evtd-b614532e.js";import"./vooks-4b323720.js";import"./vdirs-b0483831.js";import"./vueuc-64f2c6e6.js";import"./@css-render-9e983646.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-d880f9ca.js";import"./treemate-25c27bff.js";import"./date-fns-975a2d8f.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();const v=(i,e)=>{const s=i.__vccOpts||i;for(const[r,t]of e)s[r]=t;return s},le={name:"AppHeader"},de={class:"app-header"},pe=A('<div class="header-wrapper" data-v-8df9455c><nav class="app-navi" data-v-8df9455c><div class="app-title" data-v-8df9455c> Eldan Mir </div><div class="app-pages" data-v-8df9455c></div><div class="app-settings" data-v-8df9455c> Settings </div></nav></div>',1),ue=[pe];function _e(i,e,s,r,t,n){return o(),p("header",de,ue)}const me=v(le,[["render",_e],["__scopeId","data-v-8df9455c"]]);const fe={},he={class:"app-main"},ge={class:"main-warp"};function ve(i,e){return o(),p("main",he,[l("div",ge,[P(i.$slots,"default",{},void 0,!0)])])}const ye=v(fe,[["render",ve],["__scopeId","data-v-744c6ddc"]]),Ne={__name:"AppView",setup(i){return(e,s)=>(o(),p(k,null,[d(me),d(ye,null,{default:g(()=>[d(U(H))]),_:1})],64))}},be="modulepreload",Se=function(i){return"/"+i},x={},we=function(e,s,r){if(!s||s.length===0)return e();const t=document.getElementsByTagName("link");return Promise.all(s.map(n=>{if(n=Se(n),n in x)return;x[n]=!0;const a=n.endsWith(".css"),m=a?'[rel="stylesheet"]':"";if(!!r)for(let u=t.length-1;u>=0;u--){const h=t[u];if(h.href===n&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${m}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":be,a||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),a)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e()).catch(n=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n})},$e=(i,e)=>{const s=i[e];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((r,t)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+e)))})},xe={__name:"GameProvider",emits:["loading"],setup(i,{emit:e}){e("loading",!0);const s=_({});return(async t=>(await $e(Object.assign({"../GameData/Items.yaml":()=>we(()=>import("./Items-9691c21f.js"),[])}),`../GameData/${t}.yaml`)).default)("Items").then(t=>{s.value=t,setTimeout(()=>{e("loading",!1)},1e3)}),F("game",s),(t,n)=>P(t.$slots,"default")}};const Pe=i=>(E("data-v-bb161ed6"),i=i(),T(),i),Ue={class:"loading-warp"},Le={class:"loading-content"},Ae={class:"bar"},ke=Pe(()=>l("span",{class:"title"},"Loading...",-1)),Fe={class:"sub-title"},Ie={class:"res-count res"},Ee={class:"res-name res"},Te={__name:"LoadingScreen",setup(i){const e=_(0),s=I({total:5,index:1,name:"物品"});return(r,t)=>{const n=L("n-progress");return o(),p("div",Ue,[l("div",Le,[l("div",Ae,[ke,d(n,{type:"line",percentage:e.value,height:32,"border-radius":50,"fill-border-radius":0,"indicator-text-color":"#fff"},null,8,["percentage"]),l("div",Fe,[l("span",Ie,"("+N(s.index)+"/"+N(s.total)+")",1),l("span",Ee,"正在加载"+N(s.name)+"数据...",1)])])])])}}},Ce=v(Te,[["__scopeId","data-v-bb161ed6"]]);const Re={__name:"App",setup(i){const e=_(!0),s=r=>{e.value=r};return(r,t)=>{const n=L("n-config-provider");return o(),b(xe,{onLoading:s},{default:g(()=>[e.value?(o(),b(Ce,{key:0})):$("",!0),d(C,{name:"slide-in-out"},{default:g(()=>[e.value?$("",!0):(o(),b(n,{key:0,theme:U(W)},{default:g(()=>[d(Ne)]),_:1},8,["theme"]))]),_:1})]),_:1})}}};function w(i){this.callback=i,this.running=!1,this.id=-1}w.prototype.start=function(){if(this.running)return;this.running=!0;var i=this;function e(s){i.callback(s),i.running&&(i.id=requestAnimationFrame(e))}e(0)};w.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)};class Oe{constructor(e={duration:-1,autostart:!1}){let{duration:s,autostart:r}=e;this._ptime=0,this._elapsed=0,this.duration=s,this.running=!1,this.animation=new w(t=>{this.update(t)}),this.onUpdate=null,this.onTimeout=null,s>0&&r&&this.start()}update(e){if(this.duration===-1&&this.isFunc(this.onUpdate)){this.onUpdate(e);return}if(this._elapsed=this._ptime*60/1e4,this.duration>=0&&this.duration>=this._elapsed){if(!this.isFunc(this.onUpdate))return;this.onUpdate(e,this._elapsed)}else{if(!this.isFunc(this.onTimeout)){this.stop();return}this.onTimeout(),this.stop()}this._ptime++}start(){if(this.running){console.log("start timer duplicated.");return}this.animation.start(),this.running=!0}stop(){this._ptime=0,this._elapsed=0,this.animation.stop(),this.resetUpdate(),this.running=!1}resetUpdate(){this.isFunc(this.onUpdate)&&this.onUpdate(0)}pause(){this.animation.stop(),this.running=!1}isRunning(){return this.running}asTime(e=0){return e}isFunc(e){return e&&typeof e=="function"}}class Ve{constructor(e={fps:12,tolerance:.1,from:0,to:15}){this.fps=e.fps,this.t=e.tolerance,this.to=e.to,this.index=e.from||0,this.last=performance.now(),Number.isNaN(Number(this.fps)&&this.fps>0)?this.fps=1e3/60:this.fps=1e3/this.fps,this.onUpdate=null}loop(e){const s=e-this.last;s>=this.fps-this.t&&(this.last=e-s%this.fps,this.onUpdate&&typeof this.onUpdate=="function"&&this.onUpdate(this.index),this.index++),this.index<this.to&&(this.fid=requestAnimationFrame(r=>{this.loop(r)}))}start(){this.fid=requestAnimationFrame(e=>{this.loop(e)})}stop(){cancelAnimationFrame(this.fid)}}const qe={class:"sprite-warp"},Be={__name:"SpritePlayer",props:{src:{type:String,default:"#",required:!0},size:{type:[String,Number],default:16},startPosition:{type:Number,default:0},fps:{type:[String,Number],default:6},viewWidth:{type:[String,Number],default:16},viewHeight:{type:[String,Number],default:16},direction:{type:String,default:"h"}},setup(i){const e=i;R(f=>({"60a1abc8":t.value,"9a326e66":m.value,37285182:n}));const s=S(()=>e.direction),r=S(()=>new URL("../"+e.src,import.meta.url).href),t=S(()=>e.startPosition*e.size+"px"),n=e.size+"px";let a=new Ve;const m=_("");return a.onUpdate=f=>{m.value=f*e.size+"px"},a.start(),(f,c)=>(o(),p("div",qe,[l("div",{class:O(["sprites-player",s.value]),style:V({backgroundImage:`url(${r.value})`})},null,6)]))}},ze=v(Be,[["__scopeId","data-v-35ee4501"]]),He={class:"home-warp"},De={__name:"HomeView",setup(i){const e=q("game");console.log(e.value);const s=_(0);let r=new Oe({duration:3});return r.onUpdate=(t,n)=>{s.value=n},r.onTimeout=()=>{console.log("timeout")},(t,n)=>(o(),p("div",He,[d(ze,{src:"assets/images/tileset_legacy.png",size:17})]))}},Me=D({history:M("/"),routes:[{path:"/",name:"home",component:De}]});const We=j({components:[G,J,K,Q,X,Y,Z,ee,te,se,ne,ie,re,ae,oe,ce]}),y=B(Re);y.use(z());y.use(Me);y.use(We);y.mount("#app");
